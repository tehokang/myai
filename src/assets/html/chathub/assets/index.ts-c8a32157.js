import{b as a}from"./browser-polyfill-27087e75.js";import{v as r,A as u,F as p}from"./user-config-97833629.js";const d={}.VITE_PLAUSIBLE_API_HOST||"https://plausible.io";async function h(t,n){await r(`${d}/api/event`,{method:"POST",body:{domain:"chathub.gg",name:t,url:location.href,props:n},mode:"no-cors"})}async function m(){const{source:t}=await r("https://chathub.gg/api/user/source",{credentials:"include"});h("install",{source:t})}async function s(){const t=await a.tabs.query({}),n=a.runtime.getURL("app.html"),e=t.find(l=>{var i;return(i=l.url)==null?void 0:i.startsWith(n)});if(e){await a.tabs.update(e.id,{active:!0});return}const{startupPage:o}=await u(),c=o===p?"":`#/chat/${o}`;await a.tabs.create({url:`app.html${c}`})}a.action.onClicked.addListener(()=>{s()});a.runtime.onInstalled.addListener(t=>{t.reason==="install"&&(s(),m())});a.commands.onCommand.addListener(async t=>{console.debug(`Command: ${t}`),t==="open-app"&&s()});
